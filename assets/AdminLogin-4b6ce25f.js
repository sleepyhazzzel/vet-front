import{r as x,$ as _,a1 as S,aL as y,o as B,a4 as k,a6 as C,a7 as l,aM as M,h as r,aa as a,aB as F,aC as A,V as N,ad as $,ai as q}from"./index-3a07e5bb.js";import{c as L,a as d,u as P,d as p}from"./index.esm-74010b20.js";import{V as T}from"./VContainer-cf50191b.js";import{V as U}from"./VForm-9fe98b76.js";import{a as j}from"./VSelect-125a8b94.js";import{V as I}from"./VSheet-320945c0.js";import"./VList-29558c56.js";const R=q("h2",{class:"d-flex justify-center mb-3"},"管理員登入",-1),Q={__name:"AdminLogin",setup(z){const i=x([]),f=_(),c=S(),{api:m}=M(),V=y();B(async()=>{try{const{data:t}=await m.get("/admins");i.value=t.result.map(e=>({title:e.account,subtitle:e.position}))}catch(t){console.log(t)}});const b=L({account:d().required("帳號為必填欄位"),password:d().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符")}),{handleSubmit:g,isSubmitting:h}=P({validationSchema:b}),n=p("account"),u=p("password"),v=g(async t=>{var e,s;try{const{data:o}=await m.post("/admins/login",{account:t.account,password:t.password});V.login(o.result),c({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),f.push("/admin/setting")}catch(o){console.log(o);const w=((s=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:s.message)||"發生錯誤，請稍後再試";c({text:w,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(t,e)=>(k(),C(T,null,{default:l(()=>[r(I,{class:"mx-auto pa-5","max-width":"500",elevation:"4"},{default:l(()=>[R,r(U,{disabled:a(h),onSubmit:F(a(v),["prevent"])},{default:l(()=>[r(j,{label:"帳號",items:i.value,"item-props":!0,modelValue:a(n).value.value,"onUpdate:modelValue":e[0]||(e[0]=s=>a(n).value.value=s),"error-messages":a(n).errorMessage.value},null,8,["items","modelValue","error-messages"]),r(A,{label:"密碼",type:"password",minlength:"4",maxlength:"20",counter:"",modelValue:a(u).value.value,"onUpdate:modelValue":e[1]||(e[1]=s=>a(u).value.value=s),"error-messages":a(u).errorMessage.value},null,8,["modelValue","error-messages"]),r(N,{type:"submit",color:"teal",block:""},{default:l(()=>[$("登入")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1}))}};export{Q as default};
