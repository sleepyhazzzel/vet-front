import{r as n,a0 as w,b5 as B,c as A,a3 as k,a4 as D,h as o,a6 as a,a5 as N,V as c,ab as i,a7 as T,as as $,ak as F,al as I,ag as d,at as L,a8 as S,aj as j}from"./index-320b8563.js";import{V as z}from"./VDataTable-e6ca3770.js";const E={class:"text-center"},P=d("div",{class:"text-h6 mt-3 mb-8"},"確定取消預約掛號？",-1),R={class:"mb-3"},H={__name:"AppointTable",props:{id:String},setup(f){const u=f,l=n(!1),r=n(!0),m=n(""),p=n([]),{apiAuth:v}=j(),b=w(),V=B(),g=A(()=>V.meta.name.includes("病歷")?"mb-4 elevation-1":"pa-3"),y=e=>new Date(e)>=new Date,x=[{title:"日期",key:"date"},{title:"時段",key:"time"},{title:"獸醫師",key:"doctor_name"},{title:"號碼",key:"order"},{title:"取消",key:"actions",align:"center",sortable:!1}],_=async e=>{try{r.value=!0;const{data:t}=await v.get(`/appointments/${e}`);p.value=t.result}catch(t){console.log(t)}r.value=!1};_(u.id);const C=async e=>{l.value=!0,m.value=e._id},h=async()=>{try{l.value=!1,await v.delete(`/appointments/${m.value}`),_(u.id),b({text:"取消成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"success",location:"bottom"}})}catch(e){console.log(e)}};return(e,t)=>(k(),D(S,null,[o(z,{headers:x,"sort-by":[{key:"date",order:"desc"}],items:p.value,"items-per-page":10,loading:r.value,"no-data-text":"無掛號紀錄",class:$(g.value)},{"item.actions":a(({item:s})=>[!s.status&&y(s.date)?(k(),N(c,{key:0,color:"teal",variant:"text",onClick:U=>C(s)},{default:a(()=>[i("取消 ")]),_:2},1032,["onClick"])):T("",!0)]),_:2},1032,["items","loading","class"]),o(L,{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=s=>l.value=s),"max-width":"300",persistent:""},{default:a(()=>[o(F,null,{default:a(()=>[o(I,null,{default:a(()=>[d("div",E,[P,d("div",R,[o(c,{color:"teal",class:"me-3",variant:"text",onClick:t[0]||(t[0]=s=>l.value=!1)},{default:a(()=>[i("取消 ")]),_:1}),o(c,{color:"teal",onClick:h},{default:a(()=>[i("確定 ")]),_:1})])])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{H as _};
