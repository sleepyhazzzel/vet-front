import{r as x,a0 as S,a1 as k,o as w,a4 as B,a6 as N,a7 as t,h as s,V as c,i as y,ad as m,am as C,aa as l,ak as F,ap as M,al as P,ai as p,aq as T,ar as U}from"./index-d4ec24c3.js";import{u as A,a as D,d as I}from"./index.esm-c705680a.js";import{d as q}from"./index-465bd8ec.js";import{V as E}from"./VForm-8662b32e.js";const $=p("div",{class:"text-h6 mx-2 my-3"},"查詢已註冊帳號",-1),j={class:"text-end"},L={__name:"SearchDialog",emits:["update"],setup(z,{emit:f}){const i=x(!1),{apiAuth:_}=U(),d=S(),u=k(),V=f;w(()=>{d.logout()});const{handleSubmit:b,isSubmitting:v}=A({validationSchema:{national_id:D().test("isNI","身分證格式錯誤",r=>q.isNationalIdentificationNumberValid(r))}}),n=I("national_id"),g=b(async r=>{var e,a;try{const{data:o}=await _.get("/users/search",{params:{national_id:r.national_id}});i.value=!1,d.login(o.result),V("update"),u({text:"查詢成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"success",location:"bottom"}})}catch(o){const h=((a=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:a.message)||"發生錯誤，請稍後再試";u({text:h,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"error",location:"bottom"}})}});return(r,e)=>(B(),N(T,{width:500,modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a)},{activator:t(({props:a})=>[s(c,y({color:"teal",density:"compact",variant:"text",class:"align-self-start"},a),{default:t(()=>[m("查詢已註冊帳號 ")]),_:2},1040)]),default:t(()=>[s(C,null,{default:t(()=>[s(E,{disabled:l(v),onSubmit:F(l(g),["prevent"])},{default:t(()=>[s(M,null,{default:t(()=>[$,s(P,{label:"身分證字號",color:"teal",modelValue:l(n).value.value,"onUpdate:modelValue":e[0]||(e[0]=a=>l(n).value.value=a),"error-messages":l(n).errorMessage.value},null,8,["modelValue","error-messages"]),p("div",j,[s(c,{type:"submit",color:"teal",class:"mb-3"},{default:t(()=>[m("查詢")]),_:1})])]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1},8,["modelValue"]))}};export{L as _};
