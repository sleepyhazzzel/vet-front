import{r as x,$ as S,a0 as k,o as w,a3 as B,a5 as N,a6 as t,h as s,V as c,i as y,ab as m,ak as C,aa as l,ar as F,al as M,an as P,ag as p,at as T,au as U}from"./index-7e3ad466.js";import{u as A,a as D,d as I}from"./index.esm-ab988d0f.js";import{d as $}from"./index-79c3afef.js";import{V as E}from"./VForm-14b6551d.js";const j=p("div",{class:"text-h6 mx-2 my-3"},"查詢已註冊帳號",-1),q={class:"text-end"},L={__name:"SearchDialog",emits:["update"],setup(z,{emit:f}){const i=x(!1),{apiAuth:_}=U(),u=S(),d=k(),V=f;w(()=>{u.logout()});const{handleSubmit:b,isSubmitting:g}=A({validationSchema:{national_id:D().test("isNI","身分證格式錯誤",r=>$.isNationalIdentificationNumberValid(r))}}),n=I("national_id"),v=b(async r=>{var e,a;try{const{data:o}=await _.get("/users/search",{params:{national_id:r.national_id}});i.value=!1,u.login(o.result),V("update"),d({text:"查詢成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"success",location:"bottom"}})}catch(o){const h=((a=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:a.message)||"發生錯誤，請稍後再試";d({text:h,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"error",location:"bottom"}})}});return(r,e)=>(B(),N(T,{width:500,modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a)},{activator:t(({props:a})=>[s(c,y({color:"teal",density:"compact",variant:"text",class:"align-self-start"},a),{default:t(()=>[m("查詢已註冊帳號 ")]),_:2},1040)]),default:t(()=>[s(C,null,{default:t(()=>[s(E,{disabled:l(g),onSubmit:F(l(v),["prevent"])},{default:t(()=>[s(M,null,{default:t(()=>[j,s(P,{label:"身分證字號",color:"teal",modelValue:l(n).value.value,"onUpdate:modelValue":e[0]||(e[0]=a=>l(n).value.value=a),"error-messages":l(n).errorMessage.value},null,8,["modelValue","error-messages"]),p("div",q,[s(c,{type:"submit",color:"teal",class:"mb-3"},{default:t(()=>[m("查詢")]),_:1})])]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1},8,["modelValue"]))}};export{L as _};
