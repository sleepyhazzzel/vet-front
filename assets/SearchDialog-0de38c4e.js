import{r as x,a0 as S,a1 as B,o as w,a4 as C,a6 as N,a7 as t,h as s,V as c,i as k,ad as m,aD as y,aa as l,aB as F,aH as M,aC as D,ai as p,b4 as P,aM as T}from"./index-928cbe6e.js";import{u as U,a as A,d as I}from"./index.esm-e13d856f.js";import{d as E}from"./index-033d3eee.js";import{V as H}from"./VForm-f014e949.js";const $=p("div",{class:"text-h6 mx-2 my-3"},"查詢已註冊帳號",-1),j={class:"text-end"},L={__name:"SearchDialog",emits:["update"],setup(q,{emit:f}){const i=x(!1),{apiAuth:_}=T(),d=S(),u=B(),V=f;w(()=>{d.logout()});const{handleSubmit:b,isSubmitting:v}=U({validationSchema:{national_id:A().test("isNI","身分證格式錯誤",r=>E.isNationalIdentificationNumberValid(r))}}),n=I("national_id"),g=b(async r=>{var e,a;try{const{data:o}=await _.get("/users/search",{params:{national_id:r.national_id}});i.value=!1,d.login(o.result),V("update"),u({text:"查詢成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"success",location:"bottom"}})}catch(o){const h=((a=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:a.message)||"發生錯誤，請稍後再試";u({text:h,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"error",location:"bottom"}})}});return(r,e)=>(C(),N(P,{width:500,modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a)},{activator:t(({props:a})=>[s(c,k({color:"teal",density:"compact",variant:"text",class:"align-self-start"},a),{default:t(()=>[m("查詢已註冊帳號 ")]),_:2},1040)]),default:t(()=>[s(y,null,{default:t(()=>[s(H,{disabled:l(v),onSubmit:F(l(g),["prevent"])},{default:t(()=>[s(M,null,{default:t(()=>[$,s(D,{label:"身分證字號",color:"teal",modelValue:l(n).value.value,"onUpdate:modelValue":e[0]||(e[0]=a=>l(n).value.value=a),"error-messages":l(n).errorMessage.value},null,8,["modelValue","error-messages"]),p("div",j,[s(c,{type:"submit",color:"teal",class:"mb-3"},{default:t(()=>[m("查詢")]),_:1})])]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1},8,["modelValue"]))}};export{L as _};
